# Cloudflare Workers configuration for SpanishVIP Teacher Screening Bot
# -----------------------------------------------------------------------
# SETUP INSTRUCTIONS:
#
# 1. Install dependencies:
#    npm install
#
# 2. Create KV namespaces (run these commands, copy the IDs into this file):
#    npx wrangler kv namespace create BOT_KV
#    npx wrangler kv namespace create BOT_KV --preview
#
# 3. Replace the placeholder IDs below with your real namespace IDs.
#
# 4. Set secrets (never put these in this file!):
#    npx wrangler secret put BOT_TOKEN
#    npx wrangler secret put MAKE_WEBHOOK_URL
#    npx wrangler secret put MARIA_TELEGRAM_LINK
#
# 5. Deploy:
#    npx wrangler deploy
#
# 6. Set Telegram webhook (replace TOKEN and WORKER_URL):
#    curl -X POST "https://api.telegram.org/bot<BOT_TOKEN>/setWebhook" \
#      -H "Content-Type: application/json" \
#      -d '{
#        "url": "https://spanishvip-screening-bot.<your-account>.workers.dev/telegram/webhook",
#        "allowed_updates": ["message", "callback_query"],
#        "drop_pending_updates": true
#      }'
#
# 7. Verify webhook:
#    curl "https://api.telegram.org/bot<BOT_TOKEN>/getWebhookInfo"
# -----------------------------------------------------------------------

name = "spanishvip-screening-bot"
main = "src/index.ts"
compatibility_date = "2025-01-01"

[observability]
enabled = true

# --- KV Namespace Binding ---
# Replace the IDs below after running:
#   npx wrangler kv namespace create BOT_KV
#   npx wrangler kv namespace create BOT_KV --preview
[[kv_namespaces]]
binding = "BOT_KV"
id = "3fa8887f58dd4dd1a7551dbb273903c7"
preview_id = "64e222a46e9b4fbab712bf88f6696b6c"

# --- Non-secret Variables ---
# MIN_WEEKLY_HOURS: applicants with fewer available hours than this value will FAIL.
# Change this value here and redeploy to adjust the threshold without touching code.
[vars]
MIN_WEEKLY_HOURS = 15

# --- Secrets ---
# The following must be set via `wrangler secret put` (NOT here):
#   BOT_TOKEN           - Telegram bot token from @BotFather
#   MAKE_WEBHOOK_URL    - Make.com (Integromat) webhook URL to receive results
#   MARIA_TELEGRAM_LINK - Telegram link for PASS hand-off (e.g. https://t.me/mariacamila)
